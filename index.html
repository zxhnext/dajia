<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>大家</title>
	<script src="js/flexible.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="css/style1.css"> -->
    <script src="js/jquery.js"></script>  <!-- jquery,操作页面上html元素 -->
    <script src="js/velocity.min.js"></script> <!-- 动画库 -->
    <script src="js/velocity.ui.min.js"></script><!-- 动画库 -->
    <link rel="stylesheet/less" type="text/css" href="css/style.less">
    <script src="js/less.min.js" type="text/javascript"></script>
</head>
<body>
	
	<div class="cover">
		<div class="text"></div>
	</div>
	<div class="wrap">
		<div class="choose">
			<div class="txt"></div>
			<a href="javascript:void(0)" class="choose_boy"></a>
			<a href="javascript:void(0)" class="choose_girl"></a>
		</div>
		<div class="main">
			<div class="share-btn"></div>
			<div class="floor"></div>
			<div class="main-zhong"></div>
			<div class="main-zhi"></div>
			<div class="person">
				<div></div>
			</div>
			<div class="desk"></div>
			<div class="main-xing"></div>
			<div class="main-wen"></div>
			<div class="main-rui"></div>
			<div class="xingxiang">县令</div>
			<div class="btns">
				<div class="zhong ac_btn" data-daoju="zhong"></div>
				<div class="zhi ac_btn" data-daoju="zhi"></div>
				<div class="wen ac_btn" data-daoju="wen"></div>
				<div class="xing ac_btn" data-daoju="xing"></div>
				<div class="rui ac_btn" data-daoju="rui"></div>
				<div class="renwu ac_btn" data-daoju="renwu"></div>
			</div>
		</div>
		<div class="answer">
			<div class="title">关于黄圣依和杨子的感情，以下哪种观点没有在《大家》提起过？</div>
			<div class="result-options">
				<div class="opt">
					<span>A: 选项a</span>
					<div class="animation-correct"></div>
					<div class="animation-wrong"></div>
				</div>
				<div class="opt">
					<span>B: 选项b</span>
					<div class="animation-correct"></div>
					<div class="animation-wrong"></div>
				</div>
				<div class="opt">
					<span>C: 选项c</span>
					<div class="animation-correct"></div>
					<div class="animation-wrong"></div>
				</div>
			</div>
			<div class="num-count">1/3</div>
			<div class="result">
				<div class="result-wrap">
					<div class="result-title">解锁成功</div>
					<div class="result-flag"></div>
					<div class="result-text">获得猫咪</div>
				</div>
			</div>
			<div class="result-wrong">
				<div class="result-wrap">
					<div class="result-title">解锁失败</div>
					<div class="result-wrong-text">您与道具擦肩而过，再试一次吧！</div>
				</div>
			</div>
			<div class="result-person">
				<div class="result-person-wrap">
					<div class="result-person-title">答对2题</div>
					<div class="result-person-subtitle">恭喜你，人物形象升级为 </div>
					<div class="result-person-text">贵妃</div>
				</div>
			</div>
		</div>
	</div>
	<div class="loading">
		<div class="text">建议在WIFI下观看,正在加载中...</div>
		<div class="progress"></div>
		<div class="copyright">出品: xx公司出品</div>
	</div>
	<script type="text/javascript">
		var pic = ["css/answer_allopen_bg.png","css/answer_bg.png","css/answer_cat.png","css/answer_correct.png","css/answer_failed_bg.png","css/answer_rui.png","css/answer_success_bg.png","css/answer_wen.png","css/answer_wrong.png","css/answer_zhi.png","css/answer_zhong.png","css/btn-boy.png","css/btn-girl.png","css/choose_bg.png","css/choose_boy.png","css/choose_girl.png","css/choose-bg.png","css/choose-text.png","css/cover_bg.png","css/cover_clou1.png","css/cover_clou2.png","css/cover_clou3.png","css/cover_clou4.png","css/cover_text.png","css/cover-bg.png","css/cover-text.png","css/floor.jpg","css/leaf1.png","css/leaf2.png","css/leaf3.png","css/loading.jpg","css/loading_bg.png","css/loading_cloud.png","css/logo.png","css/mainscene_bg.png","css/mainscene_rui.png","css/mainscene_rui_bi.png","css/mainscene_table.png","css/mainscene_tips1.png","css/mainscene_tips2.png","css/mainscene_tips3.png","css/mainscene_tips4.png","css/mainscene_upgrade.png","css/mainscene_wen.png","css/mainscene_wen_zhi.png","css/mainscene_xing.png","css/mainscene_xing_cat.png","css/mainscene_zhi.png","css/mainscene_zhi_hua.png","css/mainscene_zhong.png","css/mainscene_zhong_bian.png","css/me_bottom.png","css/me_close.png","css/memorial_1.png","css/memorial_2.png","css/memorial_3.png","css/memorial_4.png","css/memorial_bg.png","css/memorial_up_btn.png","css/ms_chakanzouzhang.png","css/ms_taijian.png","css/p8.png","css/pop_renwu_bg.png","css/share.jpg","css/share.png","css/share_btn.png","css/upgrade_btn.png"];
		var count = 0;
		for(var i = 0;i<pic.length;i++){
			var img = new Image();
			img.src=pic[count];
			img.onload=function(){
				count++;
				var progress = Math.floor(count/pic.length*100);
				$('.progress').text(progress+'%');
				if(count ==i){
					$('.loading').hide();
					$('.wrap').show();
					$('.cover').velocity('fadeIn',{complete:function(){
						var $t = $(this);
						$t.velocity('fadeOut',{complete:function(){
							$('.choose').show();
						},delay:6000})
					}});
				}
			}
		}
		var sex = null;
		$('.choose_boy').on('click',function(){
			$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
			$('.person').find('div').removeClass().addClass('taijian');
			sex = 1;
			$('.xingxiang').text(person_result_text[sex][0]);
		})
		$('.choose_girl').on('click',function(){
			$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
			$('.person').find('div').removeClass().addClass('yatou');
			sex = 2;
			$('.xingxiang').text(person_result_text[sex][0]);
		})
		var data = {
			daoju:{
				zhong:[
					{
						question:'1、以盛产火腿闻名，也是横店影视城所在地的是浙江省的哪座地级市？',
						options:{
						A:'A、金华',
						B:'B、杭州',
						C:'C、义乌'
						},
						correct:'A'
					},
					{
	                   question:'2、以下电视剧女主角谁更“玛丽苏”？',
	                   options:{
	                       A:'A、花千骨',
	                       B:'B、何以笙箫默',
	                       C:'C、武媚娘传奇'
	                   },
	                   correct:'A'
	               },
	               {
	                   question:'3、“难得糊涂”是清朝哪一位以画竹子闻名的书画家的著名作品？',
	                   options:{
	                       A:'A、宋泽端',
	                       B:'B、赵孟頫',
	                       C:'C、郑板桥'
	                   },
	                   correct:'C'
	               }
				],
				zhi:[
	               {
	                   question:'1、N有“东方金字塔”之称著名景点西夏王陵位于哪座城市？',
	                   options:{
	                       A:'A、西宁',
	                       B:'B、西安',
	                       C:'C、银川'
	                   },
	                   correct:'C'
	               },{
	                   question:'2、《三国演义》里因其捉曹操又放曹操，并又与曹操一起逃亡的是哪位谋士？',
	                   options:{
	                       A:'A、陈宫',
	                       B:'B、荀彧',
	                       C:'C、郭嘉'
	                   },
	                   correct:'A'
	               },{
	                   question:'3、根据《大家》作者的观点，以下哪个是错误的？',
	                   options:{
	                       A:'A、《红楼梦》里面贾瑞勾引王熙凤是因为他觉得“已婚女人很寂寞”',
	                       B:'B、名人公布恋情时，获利的首先是借机打广告的企业',
	                       C:'C、同性结婚在美国是违法的'
	                   },
	                   correct:'C'
	               }
	           	],
	           	wen:[
					{
						question:'1、光明顶.天都峰都是我国哪座名山的著名景观？',
						options:{
							A:'A、昆仑山',
							B:'B、黄山',
							C:'C、华山'
						},
						correct:'B'
					}, {
						question: '2、气势恢宏的秦始皇陵是由哪位丞相主持规划设计的？',
						options: {
							A: 'A、李斯',
							B: 'B、蒙恬',
							C: 'C、赵高'
						},
						correct: 'A'
					},{
						question:'3、运筹帷幄之中，决胜千里之外”是描写谁的？',
						options:{
							A:'A、诸葛亮',
							B:'B、张良',
							C:'C、刘伯温'
						},
						correct:'B'
					}
	           	],
	           	xing:[
					{
						question:'1、我国古代神话中钻木取火的是？',
						options:{
							A:'A、神农氏',
							B:'B、女蜗氏',
							C:'C、燧人氏'
						},
						correct:'C'
					},{
						question:'2、《三国演义》中，火烧连营之计是哪位东吴将领的计谋？',
						options:{
							A:'A、陆逊',
							B:'B、周瑜',
							C:'C、鲁肃'
						},
						correct:'A'
					}, {
						question: '3、诸葛亮生前最后一战在五丈原对阵的人是谁？',
						options: {
							A: 'A、曹真',
							B: 'B、司马懿',
							C: 'C、曹操'
						},
						correct: 'B'
					}
	           	],
	           	rui:[
	               {
	                   question:'1、古代历史上在位时间最长的皇帝是？',
	                   options:{
	                       A:'A、乾隆',
	                       B:'B、康熙',
	                       C:'C、汉武帝'
	                   },
	                   correct:'B'
	               },{
						question: '2、明朝历史上在位时间最长的皇帝是？',
						options: {
							A: 'A、万历',
							B: 'B、嘉靖',
							C: 'C、明成祖'
						},
						correct: 'A'
					},{
	                   question:'3、建立东汉的开国皇帝是？',
	                   options:{
	                       A:'A、汉元帝',
	                       B:'B、更始帝',
	                       C:'C、光武帝'
	                   },
	                   correct:'C'
	               }
	           	],
	           	renwu:[
					{
	                   question:'1、东汉最后一个皇帝是？',
	                   options:{
	                       A:'A、汉献帝',
	                       B:'B、汉灵帝',
	                       C:'C、汉顺帝'
	                   },
	                   correct:'A'
	               	},{
						question: '2、魏国建立后，曹操被追封为？',
						options: {
							A: 'A、魏元帝',
							B: 'B、魏明帝',
							C: 'C、魏武帝'
						},
						correct: 'C'
					},{
	                   question:'3、蜀汉灭亡后，刘禅被司马昭封为？',
	                   options:{
	                       A:'A、山阳公',
	                       B:'B、违命侯',
	                       C:'C、安乐公'
	                   },
	                   correct:'C'
	               	},{
						question:'4、三国最后一个政权，东吴是公元哪一年灭亡的？',
						options:{
							A:'A、265年',
							B:'B、280年',
							C:'C、278年'
						},
						correct:'B'
					},{
						question:'5、中国历史上最白痴的皇帝是谁？',
						options:{
							A:'A、晋惠帝',
							B:'B、晋废帝',
							C:'C、晋哀帝'
						},
						correct:'A'
					}, {
						question: '6、谁把燕云十六州献给了契丹，被称为儿皇帝？',
						options: {
							A: 'A、石敬瑭',
							B: 'B、李存勣',
							C: 'C、刘知远'
						},
						correct: 'A'
					},{
						question:'7、下列哪个事件和宋太祖无关？',
						options:{
							A:'A、杯酒释兵权',
							B:'B、毒死李煜',
							C:'C、烛影斧声'
						},
						correct:'B'
					}, {
						question: '8、北宋最后一个皇帝是？',
						options: {
							A: 'A、宋神宗',
							B: 'B、宋徽宗',
							C: 'C、宋钦宗'
						},
						correct: 'C'
					},{
						question:'9、春秋始霸是？',
						options:{
							A:'A、秦穆公',
							B:'B、晋文公',
							C:'C、齐桓公'
						},
						correct:'C'
					},{
	                   question:'10、问鼎中原是？',
	                   options:{
	                       A:'A、秦武王',
	                       B:'B、楚庄王',
	                       C:'C、晋文公'
	                   },
	                   correct:'B'
	               }
				]
			},
			renwu:{
				1:['taijian','yayi','xianling','zaixiang','huangdi'],
				2:['yattou','xiaojie','xiaozhu','guifei','nvwang']
			}
		}
		var map_opt = {'0':'A','1':'B','2':'C'};
		var map_result_text = {'zhong':'钟匾','zhi':'屏风','wen':'宣纸','xing':'小猫','rui':'笔筒'}
		var person_result_text = {
			1:['太监','衙役','县令','宰相','皇帝'],
			2:['丫头','小姐','小主','贵妃','女王']
		}
		var result,answerCount,isfinished;
		$('.ac_btn').on('click',function(){
			result = 0;
			answerCount = 0;
			isfinished = false;
			var $t = $(this);
			if ($t.hasClass('current')) return;
			var daoju = $t.data('daoju');
			initData(daoju);
			$('.wrap').css({transform:'translateY('+-$(window).height()*2+'px)'});
		})
		var lock = false;
		$('.opt').on('click',function(){
			if (lock) return;
			lock =true;
			answerCount++;
			var $t = $(this);
			var correct = $t.closest('.result-options').data('correct');  /*closest() 返回第一个祖先元素  data()向元素附加数据*/
			var choose_val = map_opt[$t.index()];
			var daoju = $t.closest('.answer').data('daoju');
			if (choose_val == correct) {
				result++;
				correctResult(daoju,$t);
			}else{
				wrongResult(daoju,$t);
			}
			lock = false;
		})
		function initData(daoju){
			var answerIndex = 0;
			var newData = data['daoju'][daoju];
			var length = newData.length;
			answerIndex = answerCount;
			$('.num-count').text(answerIndex+1+'/'+length);
			if (length==answerIndex+1) isfinished = true;
			$('.title').text(data['daoju'][daoju][answerIndex]['question']);
			$('.opt').each(function(index,item){
				var opt = data['daoju'][daoju][answerIndex]['options'][map_opt[index]];
				var $item = $(item);
				$item.find('span').text(opt);
			});
			$('.result-options').data('correct', data['daoju'][daoju][answerIndex]['correct']);
			$('.answer').data('daoju', daoju);
		}
		function success(daoju,$t){
			$('.'+daoju).addClass('current');
			$t.find('.animation-correct').velocity('fadeIn',{complete:
				function(){
					lock = false;
					var $t = $(this);
					$t.velocity('fadeOut');
					$('.result-flag').attr('class','result-flag result-flag-'+daoju);
					$('.result-text').text('获得'+map_result_text[daoju]);
					$('.result').velocity('fadeIn',{complete:
						function(){
							var $t = $(this);
							$t.velocity('fadeOut',{complete:
								function(){
									$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
									$('.main-'+daoju).velocity('fadeIn',{delay:500})
								},delay:1000
							});
						},duration:1000
					})
				},duration:1000
			});
		}
		function faild($t,animationDom){
			$t.find(animationDom).velocity('fadeIn',{complete:
				function(){
					lock = false;
					var $t = $(this);
					$t.velocity('fadeOut');
					$('.result-wrong').velocity('fadeIn',{complete:
						function(){
							var $t = $(this);
							$t.velocity('fadeOut',{complete:
								function(){
									$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
								},delay:1000
							});
						},duration:1000
					})
				},duration:1000
			});
		}
		function renwuresult($t,animationDom){
			num = result;
			result = Math.ceil(num/2);
			if (result == 0) {
				result = 1;
			}
			$t.find(animationDom).velocity('fadeIn',{complete:
				function(){
					lock = false;
					var $t = $(this);
					$t.velocity('fadeOut');
					$('.result-person-title').text('答对'+num+'题');
					$('.result-person-text').text(person_result_text[sex][result-1]);
					$('.result-person').velocity('fadeIn',{complete:
						function(){
							var $t = $(this);
							$t.velocity('fadeOut',{complete:
								function(){
									$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
									$('.person').find('div').removeClass().addClass(data['renwu'][sex][result-1]);
									$('.xingxiang').text(person_result_text[sex][result-1]);
								},delay:1000
							});
						},duration:1000
					})
				},duration:1000
			});
		}
		function correctResult(daoju,$t){
			if (isfinished) {
				if (daoju != 'renwu') {
					if (result>=2) {
						success(daoju,$t);
					}else{
						faild($t,'.animation-correct');
					}
				}else{
					renwuresult($t,'.animation-correct');
				}
			}else{
				$t.find('.animation-correct').velocity('fadeIn',{complete:function(){
					$(this).velocity('fadeOut',{duration:1});
					initData(daoju,answerCount);
				}});

			}
		}
		function wrongResult(daoju,$t){
			if (isfinished) {
				if (daoju != 'renwu') {
					if (result<2) {
						faild($t,'.animation-wrong');
					}
				}else{
					renwuresult($t,'.animation-wrong');
				}
			}else{
				$t.find('.animation-wrong').velocity('fadeIn',{complete:function(){
					lock = false;
					$(this).velocity('fadeOut',{duration:1});
					initData(daoju,answerCount);
				}});
			}
		}
	</script>
</body>
</html>
