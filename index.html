<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>大家</title>
	<script src="js/flexible.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="css/style1.css"> -->
    <script src="js/jquery.js"></script>  <!-- jquery,操作页面上html元素 -->
    <script src="js/velocity.min.js"></script> <!-- 动画库 -->
    <script src="js/velocity.ui.min.js"></script><!-- 动画库 -->
    <link rel="stylesheet/less" type="text/css" href="css/style.less">
    <script src="js/less.min.js" type="text/javascript"></script>
</head>
<body>
	
	<div class="cover">
		<div class="text"></div>
	</div>
	<div class="wrap">
		<div class="choose">
			<div class="txt"></div>
			<a href="javascript:void(0)" class="choose_boy"></a>
			<a href="javascript:void(0)" class="choose_girl"></a>
		</div>
		<div class="main">
			<div class="share-btn"></div>
			<div class="floor"></div>
			<div class="main-zhong"></div>
			<div class="main-zhi"></div>
			<div class="person">
				<div></div>
			</div>
			<div class="desk"></div>
			<div class="main-xing"></div>
			<div class="main-wen"></div>
			<div class="main-rui"></div>
			<div class="xingxiang">县令</div>
			<div class="btns">
				<div class="zhong ac_btn" data-daoju="zhong"></div>
				<div class="zhi ac_btn" data-daoju="zhi"></div>
				<div class="wen ac_btn" data-daoju="wen"></div>
				<div class="xing ac_btn" data-daoju="xing"></div>
				<div class="rui ac_btn" data-daoju="rui"></div>
				<div class="renwu ac_btn" data-daoju="renwu"></div>
			</div>
		</div>
		<div class="answer">
			<div class="title">关于黄圣依和杨子的感情，以下哪种观点没有在《大家》提起过？</div>
			<div class="result-options">
				<div class="opt">
					<span>A: 选项a</span>
					<div class="animation-correct"></div>
					<div class="animation-wrong"></div>
				</div>
				<div class="opt">
					<span>B: 选项b</span>
					<div class="animation-correct"></div>
					<div class="animation-wrong"></div>
				</div>
				<div class="opt">
					<span>C: 选项c</span>
					<div class="animation-correct"></div>
					<div class="animation-wrong"></div>
				</div>
			</div>
			<div class="num-count">1/3</div>
			<div class="result">
				<div class="result-wrap">
					<div class="result-title">解锁成功</div>
					<div class="result-flag"></div>
					<div class="result-text">获得猫咪</div>
				</div>
			</div>
			<div class="result-wrong">
				<div class="result-wrap">
					<div class="result-title">解锁失败</div>
					<div class="result-wrong-text">您与道具擦肩而过，再试一次吧！</div>
				</div>
			</div>
			<div class="result-person">
				<div class="result-person-wrap">
					<div class="result-person-title">答对2题</div>
					<div class="result-person-subtitle">恭喜你，人物形象升级为 </div>
					<div class="result-person-text">贵妃</div>
				</div>
			</div>
		</div>
	</div>
	<div class="loading">
		<div class="text">建议在WIFI下观看,正在加载中...</div>
		<div class="progress"></div>
		<div class="copyright">出品: xx公司出品</div>
	</div>
	<script type="text/javascript">
		var pic = ["css/answer_allopen_bg.png","css/answer_bg.png","css/answer_cat.png","css/answer_correct.png","css/answer_failed_bg.png","css/answer_rui.png","css/answer_success_bg.png","css/answer_wen.png","css/answer_wrong.png","css/answer_zhi.png","css/answer_zhong.png","css/btn-boy.png","css/btn-girl.png","css/choose_bg.png","css/choose_boy.png","css/choose_girl.png","css/choose-bg.png","css/choose-text.png","css/cover_bg.png","css/cover_clou1.png","css/cover_clou2.png","css/cover_clou3.png","css/cover_clou4.png","css/cover_text.png","css/cover-bg.png","css/cover-text.png","css/floor.jpg","css/leaf1.png","css/leaf2.png","css/leaf3.png","css/loading.jpg","css/loading_bg.png","css/loading_cloud.png","css/logo.png","css/mainscene_bg.png","css/mainscene_rui.png","css/mainscene_rui_bi.png","css/mainscene_table.png","css/mainscene_tips1.png","css/mainscene_tips2.png","css/mainscene_tips3.png","css/mainscene_tips4.png","css/mainscene_upgrade.png","css/mainscene_wen.png","css/mainscene_wen_zhi.png","css/mainscene_xing.png","css/mainscene_xing_cat.png","css/mainscene_zhi.png","css/mainscene_zhi_hua.png","css/mainscene_zhong.png","css/mainscene_zhong_bian.png","css/me_bottom.png","css/me_close.png","css/memorial_1.png","css/memorial_2.png","css/memorial_3.png","css/memorial_4.png","css/memorial_bg.png","css/memorial_up_btn.png","css/ms_chakanzouzhang.png","css/ms_taijian.png","css/p8.png","css/pop_renwu_bg.png","css/share.jpg","css/share.png","css/share_btn.png","css/upgrade_btn.png"];
		var count = 0;
		for(var i = 0;i<pic.length;i++){
			var img = new Image();
			img.src=pic[count];
			img.onload=function(){
				count++;
				var progress = Math.floor(count/pic.length*100);
				$('.progress').text(progress+'%');
				if(count ==i){
					$('.loading').hide();
					$('.wrap').show();
					$('.cover').velocity('fadeIn',{complete:function(){
						var $t = $(this);
						$t.velocity('fadeOut',{complete:function(){
							$('.choose').show();
						},delay:6000})
					}});
				}
			}
		}
		var sex = null;
		$('.choose_boy').on('click',function(){
			$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
			$('.person').find('div').removeClass().addClass('taijian');
			sex = 1;
			$('.xingxiang').text(person_result_text[sex][0]);
		})
		$('.choose_girl').on('click',function(){
			$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
			$('.person').find('div').removeClass().addClass('yatou');
			sex = 2;
			$('.xingxiang').text(person_result_text[sex][0]);
		})
		var data = {
			daoju:{
				zhong:[
					{
						question:'1、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options:{
						A:'A、亿万富翁',
						B:'B、百万富翁',
						C:'C、穷光蛋'
						},
						correct:'A'
					},
					{
	                   question:'2、以下电视剧女主角谁更“玛丽苏”？',
	                   options:{
	                       A:'A、花千骨',
	                       B:'B、何以笙箫默',
	                       C:'C、武媚娘传奇'
	                   },
	                   correct:'A'
	               },
	               {
	                   question:'3、以下文章标题，哪个被读者点击次数更多？',
	                   options:{
	                       A:'A、《这世上唯一能让窦唯潦倒的人》',
	                       B:'B、《你无法证明自己不是人渣》',
	                       C:'C、《崔永元用诡辩“战胜”科学》'
	                   },
	                   correct:'A'
	               }
				],
				zhi:[
	               {
	                   question:'1、NASH是什么？',
	                   options:{
	                       A:'A、一个数学家的名字',
	                       B:'B、几个对博弈论最有贡献的人的名字合写',
	                       C:'C、A+B'
	                   },
	                   correct:'C'
	               },{
	                   question:'2、以下电视剧女主角谁更“玛丽苏”？',
	                   options:{
	                       A:'A、花千骨',
	                       B:'B、何以笙箫默',
	                       C:'C、武媚娘传奇'
	                   },
	                   correct:'A'
	               },{
	                   question:'3、根据《大家》作者的观点，以下哪个是错误的？',
	                   options:{
	                       A:'A、《红楼梦》里面贾瑞勾引王熙凤是因为他觉得“已婚女人很寂寞”',
	                       B:'B、名人公布恋情时，获利的首先是借机打广告的企业',
	                       C:'C、同性结婚在美国是违法的'
	                   },
	                   correct:'C'
	               }
	           	],
	           	wen:[
					{
						question:'1、以下文章标题，哪个被读者点击次数更多？',
						options:{
							A:'A、《这世上唯一能让窦唯潦倒的人》',
							B:'B、《你无法证明自己不是人渣》',
							C:'C、《崔永元用诡辩“战胜”科学》'
						},
						correct:'A'
					}, {
						question: '2、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options: {
							A: 'A、亿万富翁',
							B: 'B、百万富翁',
							C: 'C、穷光蛋'
						},
						correct: 'A'
					},{
						question:'3、以下电视剧女主角谁更“玛丽苏”？',
						options:{
							A:'A、花千骨',
							B:'B、何以笙箫默',
							C:'C、武媚娘传奇'
						},
						correct:'A'
					}
	           	],
	           	xing:[
					{
						question:'1、根据《大家》作者的观点，以下哪个是错误的？',
						options:{
							A:'A、《红楼梦》里面贾瑞勾引王熙凤是因为他觉得“已婚女人很寂寞”',
							B:'B、名人公布恋情时，获利的首先是借机打广告的企业',
							C:'C、同性结婚在美国是违法的'
						},
						correct:'C'
					},{
						question:'2、以下文章标题，哪个被读者点击次数更多？',
						options:{
							A:'A、《这世上唯一能让窦唯潦倒的人》',
							B:'B、《你无法证明自己不是人渣》',
							C:'C、《崔永元用诡辩“战胜”科学》'
						},
						correct:'A'
					}, {
						question: '3、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options: {
							A: 'A、亿万富翁',
							B: 'B、百万富翁',
							C: 'C、穷光蛋'
						},
						correct: 'A'
					}
	           	],
	           	rui:[
	               {
	                   question:'1、以下电视剧女主角谁更“玛丽苏”？',
	                   options:{
	                       A:'A、花千骨',
	                       B:'B、何以笙箫默',
	                       C:'C、武媚娘传奇'
	                   },
	                   correct:'A'
	               },{
						question: '2、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options: {
							A: 'A、亿万富翁',
							B: 'B、百万富翁',
							C: 'C、穷光蛋'
						},
						correct: 'A'
					},{
	                   question:'3、NASH是什么？',
	                   options:{
	                       A:'A、一个数学家的名字',
	                       B:'B、几个对博弈论最有贡献的人的名字合写',
	                       C:'C、A+B'
	                   },
	                   correct:'C'
	               }
	           	],
	           	renwu:[
					{
	                   question:'1、以下电视剧女主角谁更“玛丽苏”？',
	                   options:{
	                       A:'A、花千骨',
	                       B:'B、何以笙箫默',
	                       C:'C、武媚娘传奇'
	                   },
	                   correct:'A'
	               	},{
						question: '2、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options: {
							A: 'A、亿万富翁',
							B: 'B、百万富翁',
							C: 'C、穷光蛋'
						},
						correct: 'A'
					},{
	                   question:'3、NASH是什么？',
	                   options:{
	                       A:'A、一个数学家的名字',
	                       B:'B、几个对博弈论最有贡献的人的名字合写',
	                       C:'C、A+B'
	                   },
	                   correct:'C'
	               	},{
						question:'4、根据《大家》作者的观点，以下哪个是错误的？',
						options:{
							A:'A、《红楼梦》里面贾瑞勾引王熙凤是因为他觉得“已婚女人很寂寞”',
							B:'B、名人公布恋情时，获利的首先是借机打广告的企业',
							C:'C、同性结婚在美国是违法的'
						},
						correct:'C'
					},{
						question:'5、以下文章标题，哪个被读者点击次数更多？',
						options:{
							A:'A、《这世上唯一能让窦唯潦倒的人》',
							B:'B、《你无法证明自己不是人渣》',
							C:'C、《崔永元用诡辩“战胜”科学》'
						},
						correct:'A'
					}, {
						question: '6、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options: {
							A: 'A、亿万富翁',
							B: 'B、百万富翁',
							C: 'C、穷光蛋'
						},
						correct: 'A'
					},{
						question:'7、以下文章标题，哪个被读者点击次数更多？',
						options:{
							A:'A、《这世上唯一能让窦唯潦倒的人》',
							B:'B、《你无法证明自己不是人渣》',
							C:'C、《崔永元用诡辩“战胜”科学》'
						},
						correct:'A'
					}, {
						question: '8、如果《大家》的文章每被阅读一次，就给你一元钱，你现在是个什么级别的富人？',
						options: {
							A: 'A、亿万富翁',
							B: 'B、百万富翁',
							C: 'C、穷光蛋'
						},
						correct: 'A'
					},{
						question:'9、以下电视剧女主角谁更“玛丽苏”？',
						options:{
							A:'A、花千骨',
							B:'B、何以笙箫默',
							C:'C、武媚娘传奇'
						},
						correct:'A'
					},{
	                   question:'10、以下文章标题，哪个被读者点击次数更多？',
	                   options:{
	                       A:'A、《这世上唯一能让窦唯潦倒的人》',
	                       B:'B、《你无法证明自己不是人渣》',
	                       C:'C、《崔永元用诡辩“战胜”科学》'
	                   },
	                   correct:'A'
	               }
				]
			},
			renwu:{
				1:['taijian','yayi','xianling','zaixiang','huangdi'],
				2:['yattou','xiaojie','xiaozhu','guifei','nvwang']
			}
		}
		var map_opt = {'0':'A','1':'B','2':'C'};
		var map_result_text = {'zhong':'钟匾','zhi':'屏风','wen':'宣纸','xing':'小猫','rui':'笔筒'}
		var person_result_text = {
			1:['太监','衙役','县令','宰相','皇帝'],
			2:['丫头','小姐','小主','贵妃','女王']
		}
		var result,answerCount,isfinished;
		$('.ac_btn').on('click',function(){
			result = 0;
			answerCount = 0;
			isfinished = false;
			var $t = $(this);
			if ($t.hasClass('current')) return;
			var daoju = $t.data('daoju');
			initData(daoju);
			$('.wrap').css({transform:'translateY('+-$(window).height()*2+'px)'});
		})
		var lock = false;
		$('.opt').on('click',function(){
			if (lock) return;
			lock =true;
			answerCount++;
			var $t = $(this);
			var correct = $t.closest('.result-options').data('correct');  /*closest() 返回第一个祖先元素  data()向元素附加数据*/
			var choose_val = map_opt[$t.index()];
			var daoju = $t.closest('.answer').data('daoju');
			if (choose_val == correct) {
				result++;
				correctResult(daoju,$t);
			}else{
				wrongResult($t,daoju);
			}
			lock = false;
		})
		
		function initData(daoju){
			var answerIndex = 0;
			var newData = data['daoju'][daoju];
			var length = newData.length;
			answerIndex = answerCount;
			$('.num-count').text(answerIndex+1+'/'+length);
			if (length==answerIndex+1) isfinished = true;
			$('.title').text(data['daoju'][daoju][answerIndex]['question']);
			$('.opt').each(function(index,item){
				var opt = data['daoju'][daoju][answerIndex]['options'][map_opt[index]];
				var $item = $(item);
				$item.find('span').text(opt);
			});
			$('.result-options').data('correct', data['daoju'][daoju][answerIndex]['correct']);
			$('.answer').data('daoju', daoju);
		}
		function success(daoju,$t){
			$('.'+daoju).addClass('current');
			$t.find('.animation-correct').velocity('fadeIn',{complete:
				function(){
					lock = false;
					var $t = $(this);
					$t.velocity('fadeOut');
					$('.result-flag').attr('class','result-flag result-flag-'+daoju);
					$('.result-text').text('获得'+map_result_text[daoju]);
					$('.result').velocity('fadeIn',{complete:
						function(){
							var $t = $(this);
							$t.velocity('fadeOut',{complete:
								function(){
									$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
									$('.main-'+daoju).velocity('fadeIn',{delay:500})
								},delay:1000
							});
						},duration:1000
					})
				},duration:1000
			});
		}
		function faild($t,animationDom){
			$t.find(animationDom).velocity('fadeIn',{complete:
				function(){
					lock = false;
					var $t = $(this);
					$t.velocity('fadeOut');
					$('.result-wrong').velocity('fadeIn',{complete:
						function(){
							var $t = $(this);
							$t.velocity('fadeOut',{complete:
								function(){
									$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
								},delay:1000
							});
						},duration:1000
					})
				},duration:1000
			});
		}
		function correctResult(daoju,$t){
			if (isfinished) {
				if (daoju != 'renwu') {
					if (result>=2) {
						success(daoju,$t);
					}else{
						faild($t,'.animation-correct');
					}
				}else{
					num = result;
					result = Math.ceil(num/2);
					console.log(result);
					if (result == 0) {
						result = 1;
					}
					$t.find('.animation-correct').velocity('fadeIn',{complete:
						function(){
							lock = false;
							var $t = $(this);
							$t.velocity('fadeOut');
							$('.result-person-title').text('答对'+num+'题');
							$('.result-person-text').text(person_result_text[sex][num-1]);
							$('.result-person').velocity('fadeIn',{complete:
								function(){
									var $t = $(this);
									$t.velocity('fadeOut',{complete:
										function(){
											$('.wrap').css({transform:'translateY('+-$(window).height()+'px)'});
											$('.person').find('div').removeClass().addClass(data['renwu'][sex][result-1]);
											$('.xingxiang').text(person_result_text[sex][result-1]);
											result = 0;
										},delay:1000
									});
								},duration:1000
							})
						},duration:1000
					});

				}
			}else{
				$t.find('.animation-correct').velocity('fadeIn',{complete:function(){
					$(this).velocity('fadeOut',{duration:1});
					initData(daoju,answerCount);
				}});

			}
		}
		function wrongResult($t,daoju){
			if (isfinished) {
				if (result<2) {
					faild($t,'.animation-wrong');
				}
			}else{
				$t.find('.animation-wrong').velocity('fadeIn',{complete:function(){
					lock = false;
					$(this).velocity('fadeOut',{duration:1});
					initData(daoju,answerCount);
				}});
			}
		}
	</script>
</body>
</html>